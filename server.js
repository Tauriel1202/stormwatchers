const bodyParser = require("body-parser");
const express = require("express");

const app = express();
const dotenv = require("dotenv").config();
const port = 2024;
const cors = require("cors");

// const testData = {
//   lat: 42.0501,
//   lon: -71.8801,
//   timezone: "America/New_York",
//   timezone_offset: -18000,
//   current: {
//     dt: 1706052139,
//     sunrise: 1706011723,
//     sunset: 1706046566,
//     temp: 32.27,
//     feels_like: 32.27,
//     pressure: 1034,
//     humidity: 93,
//     dew_point: 30.65,
//     uvi: 0,
//     clouds: 100,
//     visibility: 159,
//     wind_speed: 0.87,
//     wind_deg: 300,
//     wind_gust: 1.3,
//     weather: [
//       { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//     ],
//     snow: { "1h": 0.14 },
//   },
//   minutely: [
//     { dt: 1706052180, precipitation: 0 },
//     { dt: 1706052240, precipitation: 0 },
//     { dt: 1706052300, precipitation: 0 },
//     { dt: 1706052360, precipitation: 0 },
//     { dt: 1706052420, precipitation: 0 },
//     { dt: 1706052480, precipitation: 0 },
//     { dt: 1706052540, precipitation: 0 },
//     { dt: 1706052600, precipitation: 0 },
//     { dt: 1706052660, precipitation: 0 },
//     { dt: 1706052720, precipitation: 0 },
//     { dt: 1706052780, precipitation: 0 },
//     { dt: 1706052840, precipitation: 0 },
//     { dt: 1706052900, precipitation: 0 },
//     { dt: 1706052960, precipitation: 0 },
//     { dt: 1706053020, precipitation: 0 },
//     { dt: 1706053080, precipitation: 0 },
//     { dt: 1706053140, precipitation: 0 },
//     { dt: 1706053200, precipitation: 0 },
//     { dt: 1706053260, precipitation: 0 },
//     { dt: 1706053320, precipitation: 0 },
//     { dt: 1706053380, precipitation: 0 },
//     { dt: 1706053440, precipitation: 0 },
//     { dt: 1706053500, precipitation: 0 },
//     { dt: 1706053560, precipitation: 0 },
//     { dt: 1706053620, precipitation: 0 },
//     { dt: 1706053680, precipitation: 0 },
//     { dt: 1706053740, precipitation: 0 },
//     { dt: 1706053800, precipitation: 0 },
//     { dt: 1706053860, precipitation: 0 },
//     { dt: 1706053920, precipitation: 0 },
//     { dt: 1706053980, precipitation: 0 },
//     { dt: 1706054040, precipitation: 0 },
//     { dt: 1706054100, precipitation: 0 },
//     { dt: 1706054160, precipitation: 0 },
//     { dt: 1706054220, precipitation: 0 },
//     { dt: 1706054280, precipitation: 0 },
//     { dt: 1706054340, precipitation: 0 },
//     { dt: 1706054400, precipitation: 0 },
//     { dt: 1706054460, precipitation: 0 },
//     { dt: 1706054520, precipitation: 0 },
//     { dt: 1706054580, precipitation: 0 },
//     { dt: 1706054640, precipitation: 0 },
//     { dt: 1706054700, precipitation: 0 },
//     { dt: 1706054760, precipitation: 0.143 },
//     { dt: 1706054820, precipitation: 0.1862 },
//     { dt: 1706054880, precipitation: 0.2294 },
//     { dt: 1706054940, precipitation: 0.2726 },
//     { dt: 1706055000, precipitation: 0.3158 },
//     { dt: 1706055060, precipitation: 0.3649 },
//     { dt: 1706055120, precipitation: 0.4141 },
//     { dt: 1706055180, precipitation: 0.4632 },
//     { dt: 1706055240, precipitation: 0.5124 },
//     { dt: 1706055300, precipitation: 0.5615 },
//     { dt: 1706055360, precipitation: 0.5465 },
//     { dt: 1706055420, precipitation: 0.5314 },
//     { dt: 1706055480, precipitation: 0.5164 },
//     { dt: 1706055540, precipitation: 0.5013 },
//     { dt: 1706055600, precipitation: 0.4862 },
//     { dt: 1706055660, precipitation: 0.4437 },
//     { dt: 1706055720, precipitation: 0.4011 },
//   ],
//   hourly: [
//     {
//       dt: 1706050800,
//       temp: 32.27,
//       feels_like: 32.27,
//       pressure: 1034,
//       humidity: 93,
//       dew_point: 30.65,
//       uvi: 0,
//       clouds: 100,
//       visibility: 159,
//       wind_speed: 0.87,
//       wind_deg: 300,
//       wind_gust: 1.3,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//       ],
//       pop: 0.66,
//       snow: { "1h": 0.46 },
//     },
//     {
//       dt: 1706054400,
//       temp: 32.11,
//       feels_like: 32.11,
//       pressure: 1034,
//       humidity: 95,
//       dew_point: 30.97,
//       uvi: 0,
//       clouds: 100,
//       visibility: 228,
//       wind_speed: 0.67,
//       wind_deg: 63,
//       wind_gust: 1.03,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//       ],
//       pop: 0.74,
//       snow: { "1h": 0.35 },
//     },
//     {
//       dt: 1706058000,
//       temp: 31.93,
//       feels_like: 31.93,
//       pressure: 1034,
//       humidity: 96,
//       dew_point: 31.05,
//       uvi: 0,
//       clouds: 100,
//       visibility: 203,
//       wind_speed: 1.21,
//       wind_deg: 74,
//       wind_gust: 2.3,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//       ],
//       pop: 0.91,
//       snow: { "1h": 0.27 },
//     },
//     {
//       dt: 1706061600,
//       temp: 31.77,
//       feels_like: 31.77,
//       pressure: 1035,
//       humidity: 97,
//       dew_point: 31.1,
//       uvi: 0,
//       clouds: 100,
//       visibility: 123,
//       wind_speed: 1.3,
//       wind_deg: 103,
//       wind_gust: 3.53,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//       ],
//       pop: 0.93,
//       snow: { "1h": 0.43 },
//     },
//     {
//       dt: 1706065200,
//       temp: 31.59,
//       feels_like: 31.59,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 31.15,
//       uvi: 0,
//       clouds: 100,
//       visibility: 114,
//       wind_speed: 2.1,
//       wind_deg: 99,
//       wind_gust: 5.95,
//       weather: [{ id: 601, main: "Snow", description: "snow", icon: "13n" }],
//       pop: 0.97,
//       snow: { "1h": 0.84 },
//     },
//     {
//       dt: 1706068800,
//       temp: 31.26,
//       feels_like: 27.18,
//       pressure: 1035,
//       humidity: 99,
//       dew_point: 30.74,
//       uvi: 0,
//       clouds: 100,
//       visibility: 171,
//       wind_speed: 4.05,
//       wind_deg: 107,
//       wind_gust: 9.86,
//       weather: [{ id: 601, main: "Snow", description: "snow", icon: "13n" }],
//       pop: 0.99,
//       snow: { "1h": 0.53 },
//     },
//     {
//       dt: 1706072400,
//       temp: 30.79,
//       feels_like: 26.67,
//       pressure: 1035,
//       humidity: 99,
//       dew_point: 30.13,
//       uvi: 0,
//       clouds: 100,
//       visibility: 713,
//       wind_speed: 4,
//       wind_deg: 107,
//       wind_gust: 9.93,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//       ],
//       pop: 1,
//       snow: { "1h": 0.3 },
//     },
//     {
//       dt: 1706076000,
//       temp: 30.61,
//       feels_like: 30.61,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 29.88,
//       uvi: 0,
//       clouds: 100,
//       visibility: 1140,
//       wind_speed: 2.75,
//       wind_deg: 77,
//       wind_gust: 7.16,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//       ],
//       pop: 1,
//       snow: { "1h": 0.16 },
//     },
//     {
//       dt: 1706079600,
//       temp: 30.43,
//       feels_like: 30.43,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 29.79,
//       uvi: 0,
//       clouds: 100,
//       visibility: 252,
//       wind_speed: 2.73,
//       wind_deg: 85,
//       wind_gust: 7.05,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//       ],
//       pop: 0.86,
//       snow: { "1h": 0.16 },
//     },
//     {
//       dt: 1706083200,
//       temp: 30.43,
//       feels_like: 30.43,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 29.73,
//       uvi: 0,
//       clouds: 100,
//       visibility: 1277,
//       wind_speed: 1.79,
//       wind_deg: 98,
//       wind_gust: 6.13,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//       ],
//       pop: 0.97,
//       snow: { "1h": 0.22 },
//     },
//     {
//       dt: 1706086800,
//       temp: 30.42,
//       feels_like: 30.42,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 29.77,
//       uvi: 0,
//       clouds: 100,
//       visibility: 1985,
//       wind_speed: 2.89,
//       wind_deg: 130,
//       wind_gust: 8.12,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04n",
//         },
//       ],
//       pop: 0.81,
//     },
//     {
//       dt: 1706090400,
//       temp: 30.63,
//       feels_like: 30.63,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 29.8,
//       uvi: 0,
//       clouds: 100,
//       visibility: 2380,
//       wind_speed: 2.98,
//       wind_deg: 138,
//       wind_gust: 8.95,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04n",
//         },
//       ],
//       pop: 0.73,
//     },
//     {
//       dt: 1706094000,
//       temp: 30.83,
//       feels_like: 30.83,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 29.97,
//       uvi: 0,
//       clouds: 100,
//       visibility: 1958,
//       wind_speed: 1.97,
//       wind_deg: 136,
//       wind_gust: 6.73,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04n",
//         },
//       ],
//       pop: 0.7,
//     },
//     {
//       dt: 1706097600,
//       temp: 30.87,
//       feels_like: 30.87,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 30.13,
//       uvi: 0,
//       clouds: 100,
//       visibility: 4702,
//       wind_speed: 2.46,
//       wind_deg: 138,
//       wind_gust: 8.79,
//       weather: [
//         { id: 600, main: "Snow", description: "light snow", icon: "13n" },
//         { id: 511, main: "Rain", description: "freezing rain", icon: "13n" },
//       ],
//       pop: 0.66,
//       snow: { "1h": 0.16 },
//     },
//     {
//       dt: 1706101200,
//       temp: 31.26,
//       feels_like: 31.26,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 30.42,
//       uvi: 0.04,
//       clouds: 100,
//       visibility: 7035,
//       wind_speed: 2.59,
//       wind_deg: 156,
//       wind_gust: 10.94,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04d",
//         },
//       ],
//       pop: 0.62,
//     },
//     {
//       dt: 1706104800,
//       temp: 31.73,
//       feels_like: 28.51,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 30.97,
//       uvi: 0.08,
//       clouds: 100,
//       visibility: 2911,
//       wind_speed: 3.38,
//       wind_deg: 156,
//       wind_gust: 14.23,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04d",
//         },
//       ],
//       pop: 0.6,
//     },
//     {
//       dt: 1706108400,
//       temp: 32.58,
//       feels_like: 29.35,
//       pressure: 1035,
//       humidity: 98,
//       dew_point: 31.8,
//       uvi: 0.12,
//       clouds: 100,
//       visibility: 2007,
//       wind_speed: 3.47,
//       wind_deg: 170,
//       wind_gust: 15.97,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//         { id: 511, main: "Rain", description: "freezing rain", icon: "13d" },
//       ],
//       pop: 0.62,
//       rain: { "1h": 0.11 },
//     },
//     {
//       dt: 1706112000,
//       temp: 33.39,
//       feels_like: 30.02,
//       pressure: 1034,
//       humidity: 98,
//       dew_point: 32.65,
//       uvi: 0.23,
//       clouds: 100,
//       visibility: 298,
//       wind_speed: 3.69,
//       wind_deg: 173,
//       wind_gust: 18.66,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04d",
//         },
//       ],
//       pop: 0.62,
//     },
//     {
//       dt: 1706115600,
//       temp: 33.93,
//       feels_like: 30.72,
//       pressure: 1033,
//       humidity: 99,
//       dew_point: 33.37,
//       uvi: 0.31,
//       clouds: 100,
//       visibility: 169,
//       wind_speed: 3.62,
//       wind_deg: 172,
//       wind_gust: 16.84,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.64,
//       rain: { "1h": 0.14 },
//     },
//     {
//       dt: 1706119200,
//       temp: 34.48,
//       feels_like: 31.14,
//       pressure: 1032,
//       humidity: 99,
//       dew_point: 34.03,
//       uvi: 0.23,
//       clouds: 100,
//       visibility: 150,
//       wind_speed: 3.83,
//       wind_deg: 179,
//       wind_gust: 16.15,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.61,
//       rain: { "1h": 0.16 },
//     },
//     {
//       dt: 1706122800,
//       temp: 35.06,
//       feels_like: 30.88,
//       pressure: 1031,
//       humidity: 99,
//       dew_point: 34.61,
//       uvi: 0.2,
//       clouds: 100,
//       visibility: 171,
//       wind_speed: 4.76,
//       wind_deg: 193,
//       wind_gust: 19.62,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04d",
//         },
//       ],
//       pop: 0.04,
//     },
//     {
//       dt: 1706126400,
//       temp: 35.33,
//       feels_like: 31.69,
//       pressure: 1031,
//       humidity: 100,
//       dew_point: 34.9,
//       uvi: 0.05,
//       clouds: 100,
//       visibility: 666,
//       wind_speed: 4.23,
//       wind_deg: 196,
//       wind_gust: 20.09,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04d",
//         },
//       ],
//       pop: 0.13,
//     },
//     {
//       dt: 1706130000,
//       temp: 35.22,
//       feels_like: 31.37,
//       pressure: 1030,
//       humidity: 99,
//       dew_point: 34.77,
//       uvi: 0.01,
//       clouds: 100,
//       visibility: 1971,
//       wind_speed: 4.43,
//       wind_deg: 189,
//       wind_gust: 21.34,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.36,
//       rain: { "1h": 0.1 },
//     },
//     {
//       dt: 1706133600,
//       temp: 35.69,
//       feels_like: 31.48,
//       pressure: 1030,
//       humidity: 99,
//       dew_point: 35.15,
//       uvi: 0,
//       clouds: 100,
//       visibility: 10000,
//       wind_speed: 4.92,
//       wind_deg: 182,
//       wind_gust: 22.28,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 0.52,
//       rain: { "1h": 0.21 },
//     },
//     {
//       dt: 1706137200,
//       temp: 36.18,
//       feels_like: 31.77,
//       pressure: 1029,
//       humidity: 99,
//       dew_point: 35.65,
//       uvi: 0,
//       clouds: 100,
//       visibility: 10000,
//       wind_speed: 5.26,
//       wind_deg: 186,
//       wind_gust: 23.42,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 0.54,
//       rain: { "1h": 0.17 },
//     },
//     {
//       dt: 1706140800,
//       temp: 36.84,
//       feels_like: 31.95,
//       pressure: 1029,
//       humidity: 99,
//       dew_point: 36.23,
//       uvi: 0,
//       clouds: 100,
//       visibility: 6022,
//       wind_speed: 6.08,
//       wind_deg: 186,
//       wind_gust: 23.69,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 0.76,
//       rain: { "1h": 0.41 },
//     },
//     {
//       dt: 1706144400,
//       temp: 37.51,
//       feels_like: 32.05,
//       pressure: 1027,
//       humidity: 99,
//       dew_point: 36.91,
//       uvi: 0,
//       clouds: 100,
//       visibility: 1232,
//       wind_speed: 7.14,
//       wind_deg: 195,
//       wind_gust: 27.13,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 1,
//       rain: { "1h": 0.31 },
//     },
//     {
//       dt: 1706148000,
//       temp: 38.1,
//       feels_like: 32.49,
//       pressure: 1026,
//       humidity: 99,
//       dew_point: 37.53,
//       uvi: 0,
//       clouds: 100,
//       visibility: 193,
//       wind_speed: 7.63,
//       wind_deg: 207,
//       wind_gust: 30.94,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 1,
//       rain: { "1h": 0.45 },
//     },
//     {
//       dt: 1706151600,
//       temp: 39.16,
//       feels_like: 33.3,
//       pressure: 1025,
//       humidity: 99,
//       dew_point: 38.5,
//       uvi: 0,
//       clouds: 100,
//       visibility: 170,
//       wind_speed: 8.52,
//       wind_deg: 212,
//       wind_gust: 37.98,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 1,
//       rain: { "1h": 0.57 },
//     },
//     {
//       dt: 1706155200,
//       temp: 40.62,
//       feels_like: 34.77,
//       pressure: 1024,
//       humidity: 98,
//       dew_point: 39.94,
//       uvi: 0,
//       clouds: 100,
//       visibility: 330,
//       wind_speed: 9.19,
//       wind_deg: 212,
//       wind_gust: 40.26,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 1,
//       rain: { "1h": 0.77 },
//     },
//     {
//       dt: 1706158800,
//       temp: 43.3,
//       feels_like: 37,
//       pressure: 1022,
//       humidity: 97,
//       dew_point: 42.46,
//       uvi: 0,
//       clouds: 100,
//       visibility: 2714,
//       wind_speed: 11.97,
//       wind_deg: 214,
//       wind_gust: 40.35,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 1,
//       rain: { "1h": 0.66 },
//     },
//     {
//       dt: 1706162400,
//       temp: 45.45,
//       feels_like: 39.4,
//       pressure: 1021,
//       humidity: 96,
//       dew_point: 44.13,
//       uvi: 0,
//       clouds: 100,
//       visibility: 7394,
//       wind_speed: 12.95,
//       wind_deg: 225,
//       wind_gust: 40.96,
//       weather: [
//         { id: 501, main: "Rain", description: "moderate rain", icon: "10n" },
//       ],
//       pop: 1,
//       rain: { "1h": 1.41 },
//     },
//     {
//       dt: 1706166000,
//       temp: 45.45,
//       feels_like: 39.38,
//       pressure: 1021,
//       humidity: 97,
//       dew_point: 44.38,
//       uvi: 0,
//       clouds: 100,
//       visibility: 8353,
//       wind_speed: 13.02,
//       wind_deg: 226,
//       wind_gust: 42.68,
//       weather: [
//         { id: 501, main: "Rain", description: "moderate rain", icon: "10n" },
//       ],
//       pop: 1,
//       rain: { "1h": 1.5 },
//     },
//     {
//       dt: 1706169600,
//       temp: 45.54,
//       feels_like: 39.56,
//       pressure: 1020,
//       humidity: 97,
//       dew_point: 44.51,
//       uvi: 0,
//       clouds: 100,
//       visibility: 10000,
//       wind_speed: 12.8,
//       wind_deg: 235,
//       wind_gust: 40.8,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 0.97,
//       rain: { "1h": 0.21 },
//     },
//     {
//       dt: 1706173200,
//       temp: 44.8,
//       feels_like: 39.22,
//       pressure: 1020,
//       humidity: 98,
//       dew_point: 43.95,
//       uvi: 0,
//       clouds: 100,
//       visibility: 2040,
//       wind_speed: 11.01,
//       wind_deg: 237,
//       wind_gust: 37.2,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04n",
//         },
//       ],
//       pop: 0.73,
//     },
//     {
//       dt: 1706176800,
//       temp: 44.26,
//       feels_like: 38.97,
//       pressure: 1020,
//       humidity: 98,
//       dew_point: 43.47,
//       uvi: 0,
//       clouds: 100,
//       visibility: 307,
//       wind_speed: 9.89,
//       wind_deg: 239,
//       wind_gust: 34.56,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04n",
//         },
//       ],
//       pop: 0.89,
//     },
//     {
//       dt: 1706180400,
//       temp: 43.63,
//       feels_like: 39.13,
//       pressure: 1020,
//       humidity: 99,
//       dew_point: 42.98,
//       uvi: 0,
//       clouds: 100,
//       visibility: 186,
//       wind_speed: 7.76,
//       wind_deg: 238,
//       wind_gust: 26.53,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04n",
//         },
//       ],
//       pop: 0.86,
//     },
//     {
//       dt: 1706184000,
//       temp: 43,
//       feels_like: 38.79,
//       pressure: 1020,
//       humidity: 99,
//       dew_point: 42.49,
//       uvi: 0,
//       clouds: 100,
//       visibility: 153,
//       wind_speed: 6.93,
//       wind_deg: 240,
//       wind_gust: 24.14,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 0.88,
//       rain: { "1h": 0.16 },
//     },
//     {
//       dt: 1706187600,
//       temp: 42.66,
//       feels_like: 38.88,
//       pressure: 1020,
//       humidity: 99,
//       dew_point: 42.13,
//       uvi: 0.13,
//       clouds: 100,
//       visibility: 164,
//       wind_speed: 6.06,
//       wind_deg: 243,
//       wind_gust: 22.17,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.7,
//       rain: { "1h": 0.51 },
//     },
//     {
//       dt: 1706191200,
//       temp: 42.24,
//       feels_like: 39.15,
//       pressure: 1020,
//       humidity: 100,
//       dew_point: 41.9,
//       uvi: 0.37,
//       clouds: 100,
//       visibility: 164,
//       wind_speed: 4.94,
//       wind_deg: 229,
//       wind_gust: 17.36,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.56,
//       rain: { "1h": 0.35 },
//     },
//     {
//       dt: 1706194800,
//       temp: 41.68,
//       feels_like: 39.96,
//       pressure: 1020,
//       humidity: 100,
//       dew_point: 41.34,
//       uvi: 0.66,
//       clouds: 100,
//       visibility: 427,
//       wind_speed: 3.29,
//       wind_deg: 235,
//       wind_gust: 9.98,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.56,
//       rain: { "1h": 0.23 },
//     },
//     {
//       dt: 1706198400,
//       temp: 42.19,
//       feels_like: 40.48,
//       pressure: 1021,
//       humidity: 100,
//       dew_point: 41.83,
//       uvi: 0.97,
//       clouds: 100,
//       visibility: 2346,
//       wind_speed: 3.33,
//       wind_deg: 245,
//       wind_gust: 9.51,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.56,
//       rain: { "1h": 0.23 },
//     },
//     {
//       dt: 1706202000,
//       temp: 41.92,
//       feels_like: 40.46,
//       pressure: 1020,
//       humidity: 100,
//       dew_point: 41.52,
//       uvi: 1.16,
//       clouds: 100,
//       visibility: 2341,
//       wind_speed: 3.06,
//       wind_deg: 229,
//       wind_gust: 6.73,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.56,
//       rain: { "1h": 0.22 },
//     },
//     {
//       dt: 1706205600,
//       temp: 46.38,
//       feels_like: 46.38,
//       pressure: 1019,
//       humidity: 99,
//       dew_point: 45.97,
//       uvi: 0.81,
//       clouds: 100,
//       visibility: 2507,
//       wind_speed: 1.92,
//       wind_deg: 263,
//       wind_gust: 4.07,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04d",
//         },
//       ],
//       pop: 0.56,
//     },
//     {
//       dt: 1706209200,
//       temp: 41.45,
//       feels_like: 41.45,
//       pressure: 1019,
//       humidity: 100,
//       dew_point: 41.16,
//       uvi: 0.36,
//       clouds: 100,
//       visibility: 2366,
//       wind_speed: 1.43,
//       wind_deg: 254,
//       wind_gust: 1.39,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.76,
//       rain: { "1h": 0.48 },
//     },
//     {
//       dt: 1706212800,
//       temp: 40.39,
//       feels_like: 40.39,
//       pressure: 1019,
//       humidity: 100,
//       dew_point: 40.08,
//       uvi: 0.14,
//       clouds: 100,
//       visibility: 303,
//       wind_speed: 1.3,
//       wind_deg: 332,
//       wind_gust: 1.36,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       pop: 0.78,
//       rain: { "1h": 0.45 },
//     },
//     {
//       dt: 1706216400,
//       temp: 39.79,
//       feels_like: 39.79,
//       pressure: 1019,
//       humidity: 100,
//       dew_point: 39.47,
//       uvi: 0.03,
//       clouds: 100,
//       visibility: 240,
//       wind_speed: 1.21,
//       wind_deg: 16,
//       wind_gust: 1.36,
//       weather: [
//         { id: 501, main: "Rain", description: "moderate rain", icon: "10d" },
//       ],
//       pop: 0.82,
//       rain: { "1h": 1.08 },
//     },
//     {
//       dt: 1706220000,
//       temp: 39.4,
//       feels_like: 39.4,
//       pressure: 1019,
//       humidity: 100,
//       dew_point: 39.09,
//       uvi: 0,
//       clouds: 100,
//       visibility: 225,
//       wind_speed: 2.39,
//       wind_deg: 11,
//       wind_gust: 2.21,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10n" },
//       ],
//       pop: 0.94,
//       rain: { "1h": 0.53 },
//     },
//   ],
//   daily: [
//     {
//       dt: 1706025600,
//       sunrise: 1706011723,
//       sunset: 1706046566,
//       moonrise: 1706038500,
//       moonset: 1706007840,
//       moon_phase: 0.44,
//       temp: {
//         day: 37.31,
//         min: 29.75,
//         max: 37.31,
//         night: 31.26,
//         eve: 32.09,
//         morn: 30.69,
//       },
//       feels_like: { day: 31.35, night: 27.18, eve: 32.09, morn: 23.07 },
//       pressure: 1031,
//       humidity: 64,
//       dew_point: 26.22,
//       wind_speed: 11.03,
//       wind_deg: 241,
//       wind_gust: 34.85,
//       weather: [{ id: 601, main: "Snow", description: "snow", icon: "13d" }],
//       clouds: 99,
//       pop: 0.99,
//       snow: 3.29,
//       uvi: 1.32,
//     },
//     {
//       dt: 1706112000,
//       sunrise: 1706098079,
//       sunset: 1706133042,
//       moonrise: 1706128680,
//       moonset: 1706097060,
//       moon_phase: 0.47,
//       temp: {
//         day: 33.39,
//         min: 30.42,
//         max: 40.62,
//         night: 40.62,
//         eve: 35.69,
//         morn: 30.63,
//       },
//       feels_like: { day: 30.02, night: 34.77, eve: 31.48, morn: 30.63 },
//       pressure: 1034,
//       humidity: 98,
//       dew_point: 32.65,
//       wind_speed: 9.19,
//       wind_deg: 212,
//       wind_gust: 40.26,
//       weather: [
//         { id: 616, main: "Snow", description: "rain and snow", icon: "13d" },
//       ],
//       clouds: 100,
//       pop: 1,
//       rain: 3.4,
//       snow: 1,
//       uvi: 0.31,
//     },
//     {
//       dt: 1706198400,
//       sunrise: 1706184433,
//       sunset: 1706219518,
//       moonrise: 1706218980,
//       moonset: 1706185800,
//       moon_phase: 0.5,
//       temp: {
//         day: 42.19,
//         min: 38.71,
//         max: 46.38,
//         night: 38.71,
//         eve: 39.4,
//         morn: 44.26,
//       },
//       feels_like: { day: 40.48, night: 33.3, eve: 39.4, morn: 38.97 },
//       pressure: 1021,
//       humidity: 100,
//       dew_point: 41.83,
//       wind_speed: 13.02,
//       wind_deg: 226,
//       wind_gust: 42.68,
//       weather: [
//         { id: 501, main: "Rain", description: "moderate rain", icon: "10d" },
//       ],
//       clouds: 100,
//       pop: 1,
//       rain: 13.48,
//       uvi: 1.16,
//     },
//     {
//       dt: 1706284800,
//       sunrise: 1706270785,
//       sunset: 1706305994,
//       moonrise: 1706309280,
//       moonset: 1706274000,
//       moon_phase: 0.53,
//       temp: {
//         day: 38.66,
//         min: 35.82,
//         max: 46.6,
//         night: 39.09,
//         eve: 45.77,
//         morn: 36.82,
//       },
//       feels_like: { day: 38.66, night: 34.97, eve: 40.62, morn: 33.71 },
//       pressure: 1016,
//       humidity: 99,
//       dew_point: 38.19,
//       wind_speed: 10.49,
//       wind_deg: 294,
//       wind_gust: 28.88,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       clouds: 100,
//       pop: 1,
//       rain: 2.02,
//       uvi: 1.21,
//     },
//     {
//       dt: 1706374800,
//       sunrise: 1706357135,
//       sunset: 1706392471,
//       moonrise: 1706399520,
//       moonset: 1706361900,
//       moon_phase: 0.56,
//       temp: {
//         day: 42.58,
//         min: 35.67,
//         max: 42.58,
//         night: 36.28,
//         eve: 37.49,
//         morn: 35.67,
//       },
//       feels_like: { day: 40.96, night: 32.72, eve: 35.53, morn: 33.24 },
//       pressure: 1024,
//       humidity: 74,
//       dew_point: 34.75,
//       wind_speed: 5.1,
//       wind_deg: 341,
//       wind_gust: 14.12,
//       weather: [
//         { id: 803, main: "Clouds", description: "broken clouds", icon: "04d" },
//       ],
//       clouds: 81,
//       pop: 0,
//       uvi: 1.46,
//     },
//     {
//       dt: 1706461200,
//       sunrise: 1706443484,
//       sunset: 1706478948,
//       moonrise: 1706489640,
//       moonset: 1706449560,
//       moon_phase: 0.59,
//       temp: {
//         day: 33.31,
//         min: 32.92,
//         max: 35.58,
//         night: 34.83,
//         eve: 34.81,
//         morn: 33.01,
//       },
//       feels_like: { day: 25.07, night: 25.43, eve: 25.74, morn: 27.61 },
//       pressure: 1010,
//       humidity: 98,
//       dew_point: 32.41,
//       wind_speed: 14.36,
//       wind_deg: 54,
//       wind_gust: 34.43,
//       weather: [
//         { id: 500, main: "Rain", description: "light rain", icon: "10d" },
//       ],
//       clouds: 100,
//       pop: 1,
//       rain: 7.28,
//       uvi: 2,
//     },
//     {
//       dt: 1706547600,
//       sunrise: 1706529830,
//       sunset: 1706565425,
//       moonrise: 1706579640,
//       moonset: 1706537100,
//       moon_phase: 0.62,
//       temp: {
//         day: 27.79,
//         min: 19.4,
//         max: 34.29,
//         night: 19.4,
//         eve: 21.07,
//         morn: 32.56,
//       },
//       feels_like: { day: 17.4, night: 12.36, eve: 12.27, morn: 23.07 },
//       pressure: 1005,
//       humidity: 81,
//       dew_point: 22.42,
//       wind_speed: 15.08,
//       wind_deg: 20,
//       wind_gust: 32.79,
//       weather: [
//         { id: 616, main: "Snow", description: "rain and snow", icon: "13d" },
//       ],
//       clouds: 99,
//       pop: 1,
//       rain: 0.38,
//       snow: 2.08,
//       uvi: 2,
//     },
//     {
//       dt: 1706634000,
//       sunrise: 1706616175,
//       sunset: 1706651903,
//       moonrise: 1706669700,
//       moonset: 1706624580,
//       moon_phase: 0.65,
//       temp: {
//         day: 24.75,
//         min: 18.28,
//         max: 24.75,
//         night: 19.49,
//         eve: 19.17,
//         morn: 18.28,
//       },
//       feels_like: { day: 17.64, night: 13.75, eve: 19.17, morn: 10.8 },
//       pressure: 1021,
//       humidity: 53,
//       dew_point: 9.72,
//       wind_speed: 6.02,
//       wind_deg: 2,
//       wind_gust: 13.11,
//       weather: [
//         {
//           id: 804,
//           main: "Clouds",
//           description: "overcast clouds",
//           icon: "04d",
//         },
//       ],
//       clouds: 100,
//       pop: 0,
//       uvi: 2,
//     },
//   ],
//   alerts: [
//     {
//       sender_name: "NWS Boston (Southeast New England)",
//       event: "Winter Weather Advisory",
//       start: 1706043600,
//       end: 1706151600,
//       description:
//         "...WINTER WEATHER ADVISORY IN EFFECT UNTIL 10 PM EST WEDNESDAY...\n* WHAT...Mixed precipitation expected. Total snow accumulations\nof up to two inches and ice accumulations of a light glaze.\n* WHERE...Southern Worcester County.\n* WHEN...Until 10 PM EST Wednesday.\n* IMPACTS...Plan on slippery road conditions. The hazardous\nconditions could impact the morning or evening commute.",
//       tags: ["Other dangers"],
//     },
//   ],
// };

// const axios = require('axios');

// const options = {
//   method: 'GET',
//   url: 'https://visual-crossing-weather.p.rapidapi.com/history',
//   params: {
//     startDateTime: '2023-01-01T00:00:00',
//     aggregateHours: '24',
//     location: 'Anchorage, AK, USA',
//     endDateTime: '2023-12-31T00:00:00',
//     unitGroup: 'us',
//     contentType: 'json',
//     shortColumnNames: '0'
//   },
//   headers: {
//     'X-RapidAPI-Key': 'fd11761d60msh0e2f070a51cbd7fp1439bdjsnb2b9c3db0a5c',
//     'X-RapidAPI-Host': 'visual-crossing-weather.p.rapidapi.com'
//   }
// };

// app.get("/pastAPI", async (req, res) => {
//   try {
//     const response = await axios.request(options);
//     res.send(response.data);
//   } catch (error) {
//     console.error(error);
//   }
// });

app.options("*", cors());

app.use(
  bodyParser.urlencoded({
    extended: true,
  })
);

app.set("view engine", "html");

app.use(bodyParser.json());
app.use((req, res, next) => {
  res.setHeader("Access-Control-Allow-Origin", "*");
  res.setHeader(
    "Access-Control-Allow-Methods",
    "GET, POST, PUT, DELETE, OPTIONS"
  );
  next();
});

//mongo
//accounts
const accounts = require("./mongo.js");
app.post("/account", accounts.getAccount);
app.post("/account/create", accounts.createAccount);
app.post("/account/login", accounts.login);
app.post("/account/edit", accounts.updateAccount);
app.post("/account/updateImg", accounts.updateImg);
app.post("/account/delete", accounts.deleteAccount);

//watch
app.post("/stormwatch", accounts.getPosts);
app.post("/stormwatch/postStorm", accounts.postStorm);
app.post('/stormwatch/updateStorm', accounts.updateStorm);
app.post('/stormwatch/deletePost', accounts.deletePost);

// weather api
app.get("/weatherAPI", (req, res) => {
  fetch(process.env.URL)
    .then((response) => response.json())
    .then((jsObject) => {
      res.send(jsObject);
    });
});

app.listen(port, (req, res) => {
  console.log(`🎵Listening on Port: ${port}🎵`);
});
